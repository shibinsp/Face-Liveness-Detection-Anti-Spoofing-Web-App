# üåê 3netra.in Domain Configuration Package

**Domain**: 3netra.in / www.3netra.in  
**Purpose**: Complete domain configuration for migration to another server  
**Date Created**: 2025-11-14  
**Status**: Ready for deployment on new server

---

## üìã Contents

This file contains all domain-related configurations needed to host 3netra.in on a new server:

1. **Nginx Configuration** - Reverse proxy setup
2. **SSL Certificate Information** - Let's Encrypt details
3. **Certbot Renewal Configuration** - Auto-renewal setup
4. **DNS Requirements** - Domain pointing information
5. **Deployment Instructions** - Step-by-step setup guide

---

## üîß 1. Nginx Configuration

### File Location
`/etc/nginx/sites-available/3netra.in`

### Configuration Content
```nginx
# HTTPS server block for 3netra.in domain
server {
    listen 443 ssl;
    server_name 3netra.in www.3netra.in;

    # SSL configuration
    ssl_certificate /etc/letsencrypt/live/3netra.in/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/3netra.in/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Security headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # Proxy to application (UPDATE THIS PORT/IP FOR YOUR APPLICATION)
    location / {
        proxy_pass http://127.0.0.1:YOUR_APP_PORT;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # Timeouts for processing
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
        
        # Buffer settings for streaming
        proxy_buffering off;
        proxy_request_buffering off;
    }

    # Access and error logs
    access_log /var/log/nginx/3netra.in.access.log;
    error_log /var/log/nginx/3netra.in.error.log;
}

# HTTP redirect to HTTPS
server {
    if ($host = www.3netra.in) {
        return 301 https://$host$request_uri;
    }

    if ($host = 3netra.in) {
        return 301 https://$host$request_uri;
    }

    listen 80;
    server_name 3netra.in www.3netra.in;
    return 404;
}
```

### Installation Steps
```bash
# 1. Create the configuration file
sudo nano /etc/nginx/sites-available/3netra.in
# (Paste the configuration above, update YOUR_APP_PORT)

# 2. Enable the site
sudo ln -s /etc/nginx/sites-available/3netra.in /etc/nginx/sites-enabled/

# 3. Test configuration
sudo nginx -t

# 4. Reload nginx
sudo systemctl reload nginx
```

---

## üîí 2. SSL Certificate Setup (Let's Encrypt)

### Option A: Transfer Existing Certificates (if available)
If you have access to the SSL certificates from the old server:

```bash
# Certificate paths on old server:
# /etc/letsencrypt/live/3netra.in/fullchain.pem
# /etc/letsencrypt/live/3netra.in/privkey.pem
# /etc/letsencrypt/archive/3netra.in/ (entire directory)

# Transfer to new server:
# scp -r /etc/letsencrypt/live/3netra.in user@new-server:/etc/letsencrypt/live/
# scp -r /etc/letsencrypt/archive/3netra.in user@new-server:/etc/letsencrypt/archive/
```

### Option B: Generate New Certificates (Recommended)
```bash
# 1. Install certbot
sudo apt-get update
sudo apt-get install certbot python3-certbot-nginx -y

# 2. Obtain certificate (nginx plugin will auto-configure)
sudo certbot --nginx -d 3netra.in -d www.3netra.in

# 3. Test auto-renewal
sudo certbot renew --dry-run
```

### Certbot Renewal Configuration
File: `/etc/letsencrypt/renewal/3netra.in.conf`

```ini
# renew_before_expiry = 30 days
version = 1.21.0
archive_dir = /etc/letsencrypt/archive/3netra.in
cert = /etc/letsencrypt/live/3netra.in/cert.pem
privkey = /etc/letsencrypt/live/3netra.in/privkey.pem
chain = /etc/letsencrypt/live/3netra.in/chain.pem
fullchain = /etc/letsencrypt/live/3netra.in/fullchain.pem

# Options used in the renewal process
[renewalparams]
authenticator = nginx
installer = nginx
server = https://acme-v02.api.letsencrypt.org/directory
```

**Note**: This file is auto-generated by certbot. You don't need to create it manually.

---

## üåê 3. DNS Configuration

### Required DNS Records

Point your domain to the new server's IP address:

#### A Records
```
3netra.in          ‚Üí  YOUR_NEW_SERVER_IP
www.3netra.in      ‚Üí  YOUR_NEW_SERVER_IP
```

#### Example DNS Settings
```
Type    Name              Value              TTL
A       @                 YOUR_NEW_SERVER_IP  3600
A       www               YOUR_NEW_SERVER_IP  3600
```

### Verify DNS
```bash
# Check DNS propagation
nslookup 3netra.in
nslookup www.3netra.in
dig 3netra.in
dig www.3netra.in
```

---

## üöÄ 4. Complete Deployment Instructions

### Prerequisites
- Ubuntu/Debian server with root/sudo access
- Nginx installed
- Your application running on a specific port
- Domain DNS pointing to new server IP

### Step-by-Step Setup

#### Step 1: Install Nginx (if not installed)
```bash
sudo apt-get update
sudo apt-get install nginx -y
sudo systemctl enable nginx
sudo systemctl start nginx
```

#### Step 2: Install Certbot
```bash
sudo apt-get install certbot python3-certbot-nginx -y
```

#### Step 3: Configure Nginx
```bash
# Create nginx configuration
sudo nano /etc/nginx/sites-available/3netra.in
# (Copy the nginx configuration from section 1 above)
# IMPORTANT: Update proxy_pass port to match your application

# Enable the site
sudo ln -s /etc/nginx/sites-available/3netra.in /etc/nginx/sites-enabled/

# Remove default site (optional)
sudo rm /etc/nginx/sites-enabled/default

# Test configuration
sudo nginx -t
```

#### Step 4: Obtain SSL Certificate
```bash
# Make sure DNS is pointing to this server first!
# Then run:
sudo certbot --nginx -d 3netra.in -d www.3netra.in

# Follow the prompts:
# - Enter email address
# - Agree to terms
# - Choose redirect HTTP to HTTPS (option 2)
```

#### Step 5: Verify Setup
```bash
# Test nginx
sudo nginx -t
sudo systemctl reload nginx

# Check SSL certificate
sudo certbot certificates

# Test domain
curl -I https://3netra.in
curl -I https://www.3netra.in
```

#### Step 6: Configure Firewall
```bash
# Allow HTTP and HTTPS
sudo ufw allow 'Nginx Full'
# Or specifically:
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

#### Step 7: Test Auto-Renewal
```bash
# Test certificate renewal
sudo certbot renew --dry-run

# Certificates auto-renew via systemd timer
# Check renewal status:
sudo systemctl status certbot.timer
```

---

## üîç 5. Verification Checklist

After deployment, verify:

- [ ] DNS records point to new server IP
- [ ] Nginx configuration is valid (`sudo nginx -t`)
- [ ] Nginx service is running (`sudo systemctl status nginx`)
- [ ] SSL certificate is valid (`sudo certbot certificates`)
- [ ] HTTP redirects to HTTPS (test: `curl -I http://3netra.in`)
- [ ] HTTPS works (test: `curl -I https://3netra.in`)
- [ ] Application is accessible via domain
- [ ] Both 3netra.in and www.3netra.in work
- [ ] Security headers are present
- [ ] Auto-renewal is configured

---

## üìä 6. Log Files

Monitor these log files for troubleshooting:

```bash
# Nginx access logs
sudo tail -f /var/log/nginx/3netra.in.access.log

# Nginx error logs
sudo tail -f /var/log/nginx/3netra.in.error.log

# Certbot logs
sudo tail -f /var/log/letsencrypt/letsencrypt.log
```

---

## üõ†Ô∏è 7. Troubleshooting

### Domain Not Accessible?
```bash
# Check DNS
nslookup 3netra.in

# Check nginx
sudo systemctl status nginx
sudo nginx -t

# Check firewall
sudo ufw status
```

### SSL Certificate Issues?
```bash
# Check certificate
sudo certbot certificates

# Renew manually if needed
sudo certbot renew

# Reload nginx after renewal
sudo systemctl reload nginx
```

### Application Not Responding?
```bash
# Check if your application is running
# Update proxy_pass port in nginx config if needed
# Test direct access to application
curl http://localhost:YOUR_APP_PORT
```

---

## üìù 8. Important Notes

1. **Update Proxy Port**: In the nginx configuration, change `YOUR_APP_PORT` to the actual port your application runs on.

2. **DNS Propagation**: DNS changes can take 24-48 hours to propagate globally. Use `dig` or `nslookup` to check.

3. **SSL Certificate**: If transferring certificates, ensure file permissions are correct:
   ```bash
   sudo chown -R root:root /etc/letsencrypt/
   sudo chmod -R 755 /etc/letsencrypt/
   ```

4. **Firewall**: Ensure ports 80 and 443 are open in your server's firewall.

5. **Application Port**: Make sure your application is running and accessible on the configured port before setting up nginx.

---

## üîÑ 9. Migration Checklist

When moving from old server to new server:

- [ ] Backup SSL certificates (if reusing)
- [ ] Update DNS records to point to new server IP
- [ ] Wait for DNS propagation (check with `dig`)
- [ ] Install nginx and certbot on new server
- [ ] Configure nginx with correct application port
- [ ] Obtain/transfer SSL certificates
- [ ] Test domain accessibility
- [ ] Verify HTTPS is working
- [ ] Test auto-renewal
- [ ] Monitor logs for any issues

---

## üìû 10. Quick Reference Commands

```bash
# Nginx
sudo nginx -t                    # Test configuration
sudo systemctl reload nginx      # Reload nginx
sudo systemctl status nginx      # Check status

# SSL
sudo certbot certificates        # List certificates
sudo certbot renew              # Renew certificates
sudo certbot renew --dry-run    # Test renewal

# DNS
nslookup 3netra.in              # Check DNS
dig 3netra.in                   # Detailed DNS check

# Logs
sudo tail -f /var/log/nginx/3netra.in.access.log
sudo tail -f /var/log/nginx/3netra.in.error.log
```

---

## ‚úÖ Ready for Deployment

This configuration package contains everything needed to host 3netra.in on a new server. Follow the deployment instructions above to set up the domain.

**Good luck with your migration!** üöÄ

---

*Configuration extracted from: /root/attendance_alert*  
*Original server IP: 161.97.155.89*  
*Date: 2025-11-14*

